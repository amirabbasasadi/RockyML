\hypertarget{differential__evolution_8h_source}{}\doxysection{differential\+\_\+evolution.\+h}
\label{differential__evolution_8h_source}\index{include/rocky/zagros/strategies/differential\_evolution.h@{include/rocky/zagros/strategies/differential\_evolution.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{    Copyright (C) 2022 Amirabbas Asadi , All Rights Reserved}}
\DoxyCodeLine{3 \textcolor{comment}{    distributed under Apache-\/2.0 license}}
\DoxyCodeLine{4 \textcolor{comment}{*/}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#ifndef ROCKY\_ZAGROS\_DE\_STRATEGY}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#define ROCKY\_ZAGROS\_DE\_STRATEGY}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <rocky/zagros/strategies/strategy.h>}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{keyword}{namespace }rocky\{}
\DoxyCodeLine{11 \textcolor{keyword}{namespace }zagros\{}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T\_e, \textcolor{keywordtype}{int} T\_dim>}
\DoxyCodeLine{14 \textcolor{keyword}{class }\mbox{\hyperlink{classrocky_1_1zagros_1_1basic__differential__evolution}{basic\_differential\_evolution}}: \textcolor{keyword}{public} \mbox{\hyperlink{classrocky_1_1zagros_1_1search__strategy}{search\_strategy}}<T\_e, T\_dim>\{}
\DoxyCodeLine{15 \textcolor{keyword}{protected}:}
\DoxyCodeLine{16     \mbox{\hyperlink{classrocky_1_1zagros_1_1system}{system<T\_e>}}* problem\_;}
\DoxyCodeLine{17     \textcolor{comment}{// target container}}
\DoxyCodeLine{18     \mbox{\hyperlink{classrocky_1_1zagros_1_1basic__scontainer}{basic\_scontainer<T\_e, T\_dim>}}* container\_;}
\DoxyCodeLine{19     \textcolor{comment}{// candidates container}}
\DoxyCodeLine{20     \mbox{\hyperlink{classrocky_1_1zagros_1_1basic__scontainer}{basic\_scontainer<T\_e, T\_dim>}}* candidates\_;}
\DoxyCodeLine{21     \textcolor{comment}{// DE hyper-\/parameters}}
\DoxyCodeLine{22     T\_e CR\_;}
\DoxyCodeLine{23     T\_e DW\_;}
\DoxyCodeLine{24     \textcolor{comment}{// number of crossovers}}
\DoxyCodeLine{25     \textcolor{keywordtype}{int} n\_crossovers\_;}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{keyword}{public}:}
\DoxyCodeLine{28     \mbox{\hyperlink{classrocky_1_1zagros_1_1basic__differential__evolution}{basic\_differential\_evolution}}(\mbox{\hyperlink{classrocky_1_1zagros_1_1system}{system<T\_e>}}* problem, \mbox{\hyperlink{classrocky_1_1zagros_1_1basic__scontainer}{basic\_scontainer<T\_e, T\_dim>}}* container, \mbox{\hyperlink{classrocky_1_1zagros_1_1basic__scontainer}{basic\_scontainer<T\_e, T\_dim>}}* candidates, T\_e CR=0.9, T\_e DW=0.9)\{}
\DoxyCodeLine{29         this-\/>problem\_ = problem;}
\DoxyCodeLine{30         this-\/>container\_ = container;}
\DoxyCodeLine{31         this-\/>candidates\_ = candidates;}
\DoxyCodeLine{32         this-\/>CR\_ = CR;}
\DoxyCodeLine{33         this-\/>DW\_ = DW;}
\DoxyCodeLine{34         this-\/>n\_crossovers\_ = candidates-\/>n\_particles();}
\DoxyCodeLine{35     \}}
\DoxyCodeLine{41     T\_e \mbox{\hyperlink{classrocky_1_1zagros_1_1basic__differential__evolution_aa81ea909f882cf8373309ee31b44c275}{rand\_uniform}}()\{}
\DoxyCodeLine{42         \textcolor{keyword}{static} std::uniform\_real\_distribution<T\_e> dist(0.0, 1.0);}
\DoxyCodeLine{43         \textcolor{keywordflow}{return} dist(rocky::utils::random::prng());}
\DoxyCodeLine{44     \}    }
\DoxyCodeLine{45     \textcolor{comment}{// apply differential evolution within groups in parallel}}
\DoxyCodeLine{46     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} apply()\{}
\DoxyCodeLine{47         tbb::parallel\_for(0, n\_crossovers\_, [\textcolor{keyword}{this}](\textcolor{keywordtype}{int} p)\{}
\DoxyCodeLine{48             \textcolor{keywordtype}{int} parents[4];}
\DoxyCodeLine{49             this-\/>container\_-\/>\mbox{\hyperlink{classrocky_1_1zagros_1_1basic__scontainer_a06c313144e43da64b42cb2d891d2859c}{sample\_n\_particles}}(parents, 4);}
\DoxyCodeLine{50             \textcolor{keyword}{auto}\& [x, a, b, c] = parents;}
\DoxyCodeLine{51             \textcolor{comment}{// making a copy of x}}
\DoxyCodeLine{52             std::copy(this-\/>container\_-\/>\mbox{\hyperlink{classrocky_1_1zagros_1_1basic__scontainer_ab608784fc75d08bba940962dfd5761b5}{particle}}(x),}
\DoxyCodeLine{53                       this-\/>container\_-\/>particle(x) + T\_dim,}
\DoxyCodeLine{54                       this-\/>candidates\_-\/>particle(p));}
\DoxyCodeLine{55             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} d=0; d<T\_dim; d++)\{}
\DoxyCodeLine{56                 \textcolor{comment}{// perform crossover based on the crossover probability CR}}
\DoxyCodeLine{57                 \textcolor{keywordflow}{if}(this-\/>\mbox{\hyperlink{classrocky_1_1zagros_1_1basic__differential__evolution_aa81ea909f882cf8373309ee31b44c275}{rand\_uniform}}() > this-\/>CR\_)}
\DoxyCodeLine{58                     \textcolor{keywordflow}{continue};}
\DoxyCodeLine{59                 \textcolor{comment}{// apply crossover}}
\DoxyCodeLine{60                 this-\/>candidates\_-\/>particles[p][d] = this-\/>container\_-\/>particles[a][d] +}
\DoxyCodeLine{61                                                      this-\/>DW\_ * (this-\/>container\_-\/>particles[b][d] -\/}
\DoxyCodeLine{62                                                                   this-\/>container\_-\/>particles[c][d]);            }
\DoxyCodeLine{63             \}}
\DoxyCodeLine{64         \});}
\DoxyCodeLine{65         \textcolor{comment}{// replace improved solutions}}
\DoxyCodeLine{66         candidates\_-\/>\mbox{\hyperlink{classrocky_1_1zagros_1_1basic__scontainer_a8566e2a8a6419f5c5ba60986855b5c0d}{evaluate\_and\_update}}(problem\_);}
\DoxyCodeLine{67         container\_-\/>\mbox{\hyperlink{classrocky_1_1zagros_1_1basic__scontainer_abfd37df0ae67d344d0f0640b196e0f03}{replace\_with}}(candidates\_);}
\DoxyCodeLine{68     \}}
\DoxyCodeLine{69 \};}
\DoxyCodeLine{70 }
\DoxyCodeLine{71 }
\DoxyCodeLine{72 \};}
\DoxyCodeLine{73 \};}
\DoxyCodeLine{74 }
\DoxyCodeLine{75 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
